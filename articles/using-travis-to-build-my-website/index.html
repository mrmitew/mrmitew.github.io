<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="https://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

  <title>
    
      How I use Travis CI to build my website &middot; Stefan Mitev
    
  </title>

  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-138726311-1', 'auto');
  ga('send', 'pageview');
  </script>



  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  



  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png" />
<link rel="shortcut icon" href="/favicon.png" />

  <!-- RSS -->
<!--  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />-->

  <!-- Additional head bits without overriding original head -->

<script src="/assets/js/jquery-2.1.1.min.js"></script>
</head>


  <body class="post">

    <div id="sidebar">
  <header>
    <img src="/assets/images/avatar.png" id="profile-avatar"/>
    <div class="site-title">
      <a href="/">
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        Stefan Mitev
      </a>
    </div>
    <p class="lead"></p>
  </header>
  <nav id="sidebar-nav-links">
  
    <a class="home-link "
        href="/">Home</a>
  
  

  

  


  
    
      <a class="page-link "
          href="/about/">About</a>
    
  

  
    
  

  
    
      <a class="page-link "
          href="/speaking/">Speaking</a>
    
  

  
    
  


  


  
    
  

  
    
  

  
    
  

  
    
  


  <!-- Optional additional links to insert in sidebar nav -->
</nav>


  <nav id="sidebar-icon-links">
    <a 
       class="icon" title="Github" aria-label="Github"
       href="https://github.com/mrmitew">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 28" height="24" width="28"><path d="M12 2c6.625 0 12 5.375 12 12 0 5.297-3.437 9.797-8.203 11.391-0.609 0.109-0.828-0.266-0.828-0.578 0-0.391 0.016-1.687 0.016-3.297 0-1.125-0.375-1.844-0.812-2.219 2.672-0.297 5.484-1.313 5.484-5.922 0-1.313-0.469-2.375-1.234-3.219 0.125-0.313 0.531-1.531-0.125-3.187-1-0.313-3.297 1.234-3.297 1.234-0.953-0.266-1.984-0.406-3-0.406s-2.047 0.141-3 0.406c0 0-2.297-1.547-3.297-1.234-0.656 1.656-0.25 2.875-0.125 3.187-0.766 0.844-1.234 1.906-1.234 3.219 0 4.594 2.797 5.625 5.469 5.922-0.344 0.313-0.656 0.844-0.766 1.609-0.688 0.313-2.438 0.844-3.484-1-0.656-1.141-1.844-1.234-1.844-1.234-1.172-0.016-0.078 0.734-0.078 0.734 0.781 0.359 1.328 1.75 1.328 1.75 0.703 2.141 4.047 1.422 4.047 1.422 0 1 0.016 1.937 0.016 2.234 0 0.313-0.219 0.688-0.828 0.578-4.766-1.594-8.203-6.094-8.203-11.391 0-6.625 5.375-12 12-12zM4.547 19.234c0.031-0.063-0.016-0.141-0.109-0.187-0.094-0.031-0.172-0.016-0.203 0.031-0.031 0.063 0.016 0.141 0.109 0.187 0.078 0.047 0.172 0.031 0.203-0.031zM5.031 19.766c0.063-0.047 0.047-0.156-0.031-0.25-0.078-0.078-0.187-0.109-0.25-0.047-0.063 0.047-0.047 0.156 0.031 0.25 0.078 0.078 0.187 0.109 0.25 0.047zM5.5 20.469c0.078-0.063 0.078-0.187 0-0.297-0.063-0.109-0.187-0.156-0.266-0.094-0.078 0.047-0.078 0.172 0 0.281s0.203 0.156 0.266 0.109zM6.156 21.125c0.063-0.063 0.031-0.203-0.063-0.297-0.109-0.109-0.25-0.125-0.313-0.047-0.078 0.063-0.047 0.203 0.063 0.297 0.109 0.109 0.25 0.125 0.313 0.047zM7.047 21.516c0.031-0.094-0.063-0.203-0.203-0.25-0.125-0.031-0.266 0.016-0.297 0.109s0.063 0.203 0.203 0.234c0.125 0.047 0.266 0 0.297-0.094zM8.031 21.594c0-0.109-0.125-0.187-0.266-0.172-0.141 0-0.25 0.078-0.25 0.172 0 0.109 0.109 0.187 0.266 0.172 0.141 0 0.25-0.078 0.25-0.172zM8.937 21.438c-0.016-0.094-0.141-0.156-0.281-0.141-0.141 0.031-0.234 0.125-0.219 0.234 0.016 0.094 0.141 0.156 0.281 0.125s0.234-0.125 0.219-0.219z"></path>
</svg>

    </a>
    <a
        class="icon" title="LinkedIn" aria-label="LinkedIn"
        href="https://nl.linkedin.com/in/stefan-mitev-82546972">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"/></svg>
    </a>
    <a
       class="icon" title="Twitter" aria-label="Twitter"
       href="https://twitter.com/steffmitev">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"/></svg>
    </a>

<!--  <a id="subscribe-link"-->
<!--     class="icon" title="Subscribe" aria-label="Subscribe"-->
<!--     href="/feed.xml">-->
<!--    <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>-->
<!--  </a>-->

  
  
  
  

  
    <a id="tags-link"
       class="icon"
       title="Tags" aria-label="Tags"
       href="/tags/">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M10.605 0h-10.605v10.609l13.391 13.391 10.609-10.604-13.395-13.396zm-4.191 6.414c-.781.781-2.046.781-2.829.001-.781-.783-.781-2.048 0-2.829.782-.782 2.048-.781 2.829-.001.782.782.781 2.047 0 2.829z"/></svg>
    </a>
  

  
    <a id="search-link"
       class="icon"
       title="Search" aria-label="Search"
       href="/search/">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M23.809 21.646l-6.205-6.205c1.167-1.605 1.857-3.579 1.857-5.711 0-5.365-4.365-9.73-9.731-9.73-5.365 0-9.73 4.365-9.73 9.73 0 5.366 4.365 9.73 9.73 9.73 2.034 0 3.923-.627 5.487-1.698l6.238 6.238 2.354-2.354zm-20.955-11.916c0-3.792 3.085-6.877 6.877-6.877s6.877 3.085 6.877 6.877-3.085 6.877-6.877 6.877c-3.793 0-6.877-3.085-6.877-6.877z"/></svg>
    </a>
  

  <!-- Optional additional links to insert for icons links -->
</nav>

  <p>
  &copy; 2019.
  <a href="/LICENSE.md">Apache 2.0</a>
</p>


  
</div>

    <main class="container">
      <header>
  <h1 class="post-title">How I use Travis CI to build my website</h1>
</header>
<div class="content">
  <div class="post-meta">
  <span class="post-date">21 Apr 2019</span>
  <span class="post-categories">
    
  </span>
</div>


  <div class="post-body">
    <h2 id="contents">Contents:</h2>
<ul>
  <li>How was this website built
    <ul>
      <li>What is Jekyll</li>
      <li>What is Github Pages</li>
      <li>What is Travis CI</li>
    </ul>
  </li>
  <li>How is the website repository organized
    <ul>
      <li>Workflow</li>
    </ul>
  </li>
  <li>Setup
    <ul>
      <li>Github repo</li>
      <li>Travis CI</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p><strong>Disclaimer:</strong> This is not a general how-to article. Its more of an explanatory article for how I setup my website and everything else needed for having automatic deployments.</p>
</blockquote>

<h1 id="how-was-this-website-built">How was this website built</h1>

<p>This website is powered by <a href="https://jekyllrb.com/">Jekyll</a> which utilizes the <a href="https://github.com/fongandrew/hydeout">Hydeout</a> theme that I modified to my liking.</p>

<blockquote>
  <p>Jekyll is a powerful and extendable static site generator. Content is written in <a href="TODO">markdown</a> and pages are generated using templates.</p>
</blockquote>

<p>The website and blog are hosted on <a href="https://pages.github.com/">Github Pages</a> and are being automatically deployed by <a href="https://travis-ci.org/">Travis CI</a> whenever I make a change. A little further you will read the implementation details.</p>

<blockquote>
  <p>Github Pages is a free hosting, provided by Github for personal and/or project websites. You can learn more about it <a href="https://pages.github.com/">here</a>.</p>
</blockquote>

<p>If you are curious to see the source code of the website, you can check it out on my <a href="https://github.com/mrmitew/mrmitew.github.io/">Github</a>. In fact, if you were to clone the repository, you’ll be able to run it locally with no effort at all.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/mrmitew/mrmitew.github.io.git mitevstefan
<span class="nb">cd </span>mitevstefan
bundle <span class="nb">exec </span>jekyll serve
</code></pre></div></div>

<p><code class="highlighter-rouge">jekyll serve</code> builds the website any time a source file changes and serves it locally. To find out the address you should visit, look for the “Server address” output line in the terminal. By default it should be <code class="highlighter-rouge">http://127.0.0.1:4000/</code>.</p>

<h1 id="how-is-the-website-repository-organized">How is the website repository organized</h1>

<p>There are three active branches, namely <code class="highlighter-rouge">master</code>, <code class="highlighter-rouge">release</code> and <code class="highlighter-rouge">develop</code>.</p>

<ul>
  <li><code class="highlighter-rouge">master</code> branch contains the generated static site content (the one you will find in the <code class="highlighter-rouge">_site</code> folder)</li>
  <li><code class="highlighter-rouge">release</code> branch contains the jekyll code, including configs, layouts, sass, markdown files etc (everything needed to generate the website)</li>
  <li><code class="highlighter-rouge">develop</code> branch is a working copy of the <code class="highlighter-rouge">release</code> branch. It contains code and content that is not yet in production.</li>
</ul>

<h2 id="workflow">Workflow</h2>

<p>New changes are done in <code class="highlighter-rouge">develop</code>. When those are merged to <code class="highlighter-rouge">release</code>, Travis CI would trigger a new build and deploy the newly generated static content onto <code class="highlighter-rouge">master</code>. As soon that is done, the changes can be observed by visiting <code class="highlighter-rouge">mitevstefan.com</code> or <code class="highlighter-rouge">mrmitew.github.io</code>.</p>

<h1 id="setup">Setup</h1>

<h2 id="git--github">Git + Github</h2>

<ul>
  <li>Created a new repository <code class="highlighter-rouge">mrmitew.github.io</code> - its important to use your github username for the subdomain.</li>
  <li>Created <code class="highlighter-rouge">release</code> and <code class="highlighter-rouge">develop</code> branches.</li>
  <li>From the repository settings I chose <code class="highlighter-rouge">release</code> as a default branch, so that it will be the ‘landing’ branch when someone would open the repository.</li>
  <li>Ran <code class="highlighter-rouge">bundle exec jekyll build</code> on my local machine to generate the static content and pushed it to <code class="highlighter-rouge">master</code>.</li>
  <li>Switched to <code class="highlighter-rouge">release</code>, which at this point was still empty*.</li>
  <li>Created a <code class="highlighter-rouge">.gitignore</code> file to exclude some files and directories I did not want to commit:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.idea/*
_site/*
Gemfile.lock
.sass-cache/
</code></pre></div>    </div>
  </li>
  <li>Added the jekyll code in the root directory</li>
  <li>Pushed to the remote <code class="highlighter-rouge">release</code> branch.</li>
  <li>Since I wanted to use my own domain and not <code class="highlighter-rouge">mrmitew.github.io</code>, I created <code class="highlighter-rouge">A</code> records through my DNS provider that pointed to GitHub’s IP addresses. Click</li>
  <li><a href="https://help.github.com/en/articles/using-a-custom-domain-with-github-pages">here</a> for more info.</li>
  <li>Entered my custom domain name from the <em>“GitHub Pages”</em> section in the repository settings and also ticked the box for enforcing HTTPS.</li>
</ul>

<p><em>* In fact, that’s what I was aiming to do, but in reality <code class="highlighter-rouge">release</code> was created after pushing to <code class="highlighter-rouge">master</code> with the static content already in it, so I had to delete it first.</em></p>

<h2 id="travis-ci">Travis CI</h2>

<ul>
  <li>Headed over to <a href="https://travis-ci.org/">Travis CI</a> and created a new account, which took less than a minute. After syncing my GitHub repositories, I enabled the Travis CI integration for <code class="highlighter-rouge">mrmitew.github.io</code> repository.</li>
  <li>From <a href="https://github.com/settings/tokens">GitHub’s Developer settings</a> I created a new personal access token and gave it a custom name. From there, I selected <code class="highlighter-rouge">repo:status</code>, <code class="highlighter-rouge">repo_deployment</code> and <code class="highlighter-rouge">public_repo</code> scopes.</li>
  <li>Generated the new access token and copied it for later usage in the Travis CI dashboard. It is important to copy it before closing the page because there is no possible way to retrieve it again.</li>
  <li>In Travis CI dashboard, I created a new environment variable <code class="highlighter-rouge">GITHUB_TOKEN</code> with value equals to the token, generated earlier.</li>
  <li>Finally, I committed on the <code class="highlighter-rouge">release</code> branch a new file, called <code class="highlighter-rouge">.travis.yml</code> that contained instructions for Travis CI:</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="ss">language: </span><span class="n">ruby</span>
<span class="ss">cache: </span><span class="n">bundler</span>
<span class="ss">branches:
  only:
    </span><span class="o">-</span> <span class="n">release</span>
<span class="ss">script:
  </span><span class="o">-</span> <span class="no">JEKYLL_ENV</span><span class="o">=</span><span class="n">production</span> <span class="n">bundle</span> <span class="nb">exec</span> <span class="n">jekyll</span> <span class="n">build</span> <span class="o">--</span><span class="n">destination</span> <span class="n">_site</span>
<span class="ss">deploy:
  fqdn: </span><span class="n">mitevstefan</span><span class="p">.</span><span class="nf">com</span>
  <span class="ss">provider: </span><span class="n">pages</span>
  <span class="n">local</span><span class="o">-</span><span class="ss">dir: </span><span class="p">.</span><span class="nf">/</span><span class="n">_site</span>
  <span class="n">target</span><span class="o">-</span><span class="ss">branch: </span><span class="n">master</span>
  <span class="ss">email: </span><span class="n">deploy</span><span class="vi">@travis</span><span class="o">-</span><span class="n">ci</span><span class="p">.</span><span class="nf">org</span>
  <span class="ss">name: </span><span class="no">Deployment</span> <span class="no">Bot</span>
  <span class="n">skip</span><span class="o">-</span><span class="ss">cleanup: </span><span class="kp">true</span>
  <span class="n">github</span><span class="o">-</span><span class="ss">token: </span><span class="vg">$GITHUB_TOKEN</span>
  <span class="n">keep</span><span class="o">-</span><span class="ss">history: </span><span class="kp">true</span>
  <span class="ss">on:
    branch: </span><span class="n">release</span>
</code></pre></div></div>
<ul>
  <li>Pushing it to <code class="highlighter-rouge">release</code>, triggered the first successful build and deployment by Travis CI :)</li>
</ul>

<h1 id="further-reading">Further reading</h1>
<ul>
  <li><a href="https://help.github.com/en/articles/using-a-custom-domain-with-github-pages">Using a custom domain with GitHub Pages</a></li>
  <li><a href="https://docs.travis-ci.com/user/deployment/pages/">.travis.yml configuration for GitHub Pages</a></li>
</ul>

    



<div class="post-tags">
  
    
    <a href="/tags/#ci">
    
      <span class="icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M10.605 0h-10.605v10.609l13.391 13.391 10.609-10.604-13.395-13.396zm-4.191 6.414c-.781.781-2.046.781-2.829.001-.781-.783-.781-2.048 0-2.829.782-.782 2.048-.781 2.829-.001.782.782.781 2.047 0 2.829z"/></svg>
      </span>&nbsp;<span class="tag-name">CI</span>
    </a>
  
    
    <a href="/tags/#jekyll">
    
      <span class="icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M10.605 0h-10.605v10.609l13.391 13.391 10.609-10.604-13.395-13.396zm-4.191 6.414c-.781.781-2.046.781-2.829.001-.781-.783-.781-2.048 0-2.829.782-.782 2.048-.781 2.829-.001.782.782.781 2.047 0 2.829z"/></svg>
      </span>&nbsp;<span class="tag-name">jekyll</span>
    </a>
  
</div>
  </div>

  
  
</div>

    </main>

    <!-- Optional footer content -->

  </body>
</html>
